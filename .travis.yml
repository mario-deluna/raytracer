language: php

notifications:
  email: false

jobs:
  include:
    - stage: "Unit Tests"
      php: 7.3
      env: phpunit
      script:
        - ./tools/phpunit --coverage-clover=coverage.xml
      after_success:
        - bash <(curl -s https://codecov.io/bash)
    - stage: "Static Code Analysis"
      php: 7.3
      env: php-cs-fixer
      install:
        - phpenv config-rm xdebug.ini
      script:
        - ./tools/php-cs-fixer fix --dry-run -v --show-progress=dots --diff-format=udiff
    - stage: "Static Code Analysis"
      php: 7.3
      env: psalm
      install:
        - phpenv config-rm xdebug.ini
      script:
        - ./tools/psalm --no-progress --shepherd --stats
